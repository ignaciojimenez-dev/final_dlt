{
  "dataflows": [
    {
      "name": "df1_person_flow",
      "bronze_sinks": [
        { 
            "input": "person_inputs", 
            "name": "bronze_person",
            "location": "/Volumes/dev_dlt/esquema_ingesta/volumen_storage_tables/bronze_person" 
        }
      ],
      "sources": [
        {
          "name": "person_inputs", 
          "paths": "/Volumes/dev_dlt/esquema_ingesta/volumen_data_person/*"
          , 
          "format": "JSON",
          "schema_location": "/Volumes/dev_dlt/esquema_ingesta/volumen_schema_checkpoint/bronze_person_json",
          "options": {
          }
        },
        {
          "name": "person_inputs", 
          "path": "/Volumes/dev_dlt/esquema_ingesta/volumen_data_person_csv/*",
          "format": "CSV",
          "schema_location": "/Volumes/dev_dlt/esquema_ingesta/volumen_schema_checkpoint/bronze_person_csv",
          "options": {
              "header": "true",
              "delimiter": ";"
          }
        }
      ],
      "silver_logic": {
            "target_silver_table": "silver_person_clean",
            "target_location": "/Volumes/dev_dlt/esquema_ingesta/volumen_storage_tables/silver_person_ok",
            "source_bronze": "bronze_person",
            
            "validations": [
                {"field": "office", "validations": ["notEmpty"]},
                {"field": "age", "validations": ["notNull"]}
            ],
            
            "quarantine_location": "/Volumes/dev_dlt/esquema_ingesta/volumen_storage_tables/silver_person_quarantine",
            
            "transformations": [
                {"target_col": "ingestion_ts", "type": "current_timestamp", "params": null},
                {"target_col": "age_group", "type": "sql_expr", "params": "CASE WHEN age > 18 THEN 'Adult' ELSE 'Minor' END"}
            ],
            
            "scd_config": {
                "keys": ["id"],
                "sequence_by": "ts",
                "stored_as_scd_type": 1
            }
      }
    }
  ]
}